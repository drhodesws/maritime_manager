{% extends 'base.html' %}

{% block content %}
    <div class="header" style="background-color: {{ header_color|default('#1da1f2') }}; color: white; padding: 15px; border-radius: 8px 8px 0 0; margin-bottom: 10px; font-size: 24px; font-weight: bold;">
        <h1>{{ action }} Employee</h1>
        <p style="font-size: 14px; font-weight: normal;">{{ 'Add' if action == 'Create' else 'Edit' }} employee details.</p>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <p style="color: {{ 'green' if category == 'success' else 'red' }}; padding: 10px; margin-top: 10px; border-radius: 4px; background-color: #f9f9f9;">{{ message }}</p>
                {% endfor %}
            {% endif %}
        {% endwith %}
        {% if form.errors %}
            <p style="color: red; padding: 10px; margin-top: 10px; border-radius: 4px; background-color: #f9f9f9;">Please correct the following errors: {% for field, errors in form.errors.items() %}{{ field }}: {{ errors|join(', ') }}{% if not loop.last %}, {% endif %}{% endfor %}</p>
        {% endif %}
    </div>
    <div style="max-width: 1200px; margin: 10px 0; padding: 20px; background-color: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">
        <form method="POST" action="" style="display: flex; flex-direction: column; gap: 20px;">
            {{ form.hidden_tag() }} <!-- CSRF token -->
            <fieldset style="border: 1px solid #ddd; padding: 15px; border-radius: 4px;">
                <legend style="font-weight: bold; padding: 0 10px;">Personal Information</legend>
                <div style="display: flex; gap: 20px;">
                    <div style="flex: 2;">
                        <label for="{{ form.full_name.id }}">{{ form.full_name.label }}</label>
                        {{ form.full_name(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1;">
                        <label for="{{ form.date_of_birth.id }}">{{ form.date_of_birth.label }}</label>
                        <input type="date" id="{{ form.date_of_birth.id }}" name="{{ form.date_of_birth.name }}" value="{{ form.date_of_birth.data|default('', true) if form.date_of_birth.data else '' }}" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;">
                    </div>
                    <div style="flex: 2;">
                        <label for="{{ form.contact_info.id }}">{{ form.contact_info.label }}</label>
                        {{ form.contact_info(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                </div>
                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <div style="flex: 3;">
                        <label for="{{ form.address.id }}">{{ form.address.label }}</label>
                        {{ form.address(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                </div>
            </fieldset>
            <fieldset style="border: 1px solid #ddd; padding: 15px; border-radius: 4px;">
                <legend style="font-weight: bold; padding: 0 10px;">Employment Information</legend>
                <div style="display: flex; gap: 20px;">
                    <div style="flex: 1;">
                        <label for="{{ form.hire_date.id }}">{{ form.hire_date.label }}</label>
                        <input type="date" id="{{ form.hire_date.id }}" name="{{ form.hire_date.name }}" value="{{ form.hire_date.data|default('', true) if form.hire_date.data else '' }}" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;">
                    </div>
                    <div style="flex: 2;">
                        <label for="{{ form.role_position.id }}">{{ form.role_position.label }}</label>
                        {{ form.role_position(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                </div>
                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <div style="flex: 1;">
                        <label for="{{ form.payrate_rt.id }}">{{ form.payrate_rt.label }}</label>
                        <input type="number" step="0.01" id="{{ form.payrate_rt.id }}" name="{{ form.payrate_rt.name }}" value="{{ form.payrate_rt.data|default('', true) if form.payrate_rt.data else '' }}" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;">
                    </div>
                    <div style="flex: 1;">
                        <label for="{{ form.payrate_ot.id }}">{{ form.payrate_ot.label }}</label>
                        <input type="number" step="0.01" id="{{ form.payrate_ot.id }}" name="{{ form.payrate_ot.name }}" value="{{ form.payrate_ot.data|default('', true) if form.payrate_ot.data else '' }}" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;">
                    </div>
                    <div style="flex: 1;">
                        <label for="{{ form.years_of_experience.id }}">{{ form.years_of_experience.label }}</label>
                        <input type="number" id="{{ form.years_of_experience.id }}" name="{{ form.years_of_experience.name }}" value="{{ form.years_of_experience.data|default('', true) if form.years_of_experience.data else '' }}" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;">
                    </div>
                </div>
            </fieldset>
            <fieldset style="border: 1px solid #ddd; padding: 15px; border-radius: 4px;">
                <legend style="font-weight: bold; padding: 0 10px;">Certifications</legend>
                <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.stcw_certification.id }}">{{ form.stcw_certification.label }}</label>
                        {{ form.stcw_certification(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.twic_card.id }}">{{ form.twic_card.label }}</label>
                        {{ form.twic_card(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.merchant_mariner_credential_mmc.id }}">{{ form.merchant_mariner_credential_mmc.label }}</label>
                        {{ form.merchant_mariner_credential_mmc(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.electro_technical_officer_eto_certification.id }}">{{ form.electro_technical_officer_eto_certification.label }}</label>
                        {{ form.electro_technical_officer_eto_certification(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.osha_safety_certifications.id }}">{{ form.osha_safety_certifications.label }}</label>
                        {{ form.osha_safety_certifications(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.first_aid_cpr_aed.id }}">{{ form.first_aid_cpr_aed.label }}</label>
                        {{ form.first_aid_cpr_aed(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.huet_bosiet.id }}">{{ form.huet_bosiet.label }}</label>
                        {{ form.huet_bosiet(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.gmdss_operator.id }}">{{ form.gmdss_operator.label }}</label>
                        {{ form.gmdss_operator(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.vessel_tonnage_rating.id }}">{{ form.vessel_tonnage_rating.label }}</label>
                        {{ form.vessel_tonnage_rating(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.domestic_international_endorsement.id }}">{{ form.domestic_international_endorsement.label }}</label>
                        {{ form.domestic_international_endorsement(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.able_seafarer_deck_engine_ab_rating.id }}">{{ form.able_seafarer_deck_engine_ab_rating.label }}</label>
                        {{ form.able_seafarer_deck_engine_ab_rating(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.radar_arpa_endorsement.id }}">{{ form.radar_arpa_endorsement.label }}</label>
                        {{ form.radar_arpa_endorsement(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.ecdis_certification.id }}">{{ form.ecdis_certification.label }}</label>
                        {{ form.ecdis_certification(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                </div>
            </fieldset>
            <fieldset style="border: 1px solid #ddd; padding: 15px; border-radius: 4px;">
                <legend style="font-weight: bold; padding: 0 10px;">Skills and Proficiencies</legend>
                <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.power_tools_proficiency.id }}">{{ form.power_tools_proficiency.label }}</label>
                        {{ form.power_tools_proficiency(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.multi_meter_usage.id }}">{{ form.multi_meter_usage.label }}</label>
                        {{ form.multi_meter_usage(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.nvrip_camera_systems.id }}">{{ form.nvrip_camera_systems.label }}</label>
                        {{ form.nvrip_camera_systems(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.marine_electronics_expertise.id }}">{{ form.marine_electronics_expertise.label }}</label>
                        {{ form.marine_electronics_expertise(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.uhf_vhf_radio_handling.id }}">{{ form.uhf_vhf_radio_handling.label }}</label>
                        {{ form.uhf_vhf_radio_handling(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                </div>
            </fieldset>
            <fieldset style="border: 1px solid #ddd; padding: 15px; border-radius: 4px;">
                <legend style="font-weight: bold; padding: 0 10px;">Logs and History</legend>
                <div style="display: flex; flex-wrap: wrap; gap: 20px;">
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.training_completion_log.id }}">{{ form.training_completion_log.label }}</label>
                        {{ form.training_completion_log(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.performance_reviews.id }}">{{ form.performance_reviews.label }}</label>
                        {{ form.performance_reviews(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.upgrade_eligibility_flags.id }}">{{ form.upgrade_eligibility_flags.label }}</label>
                        {{ form.upgrade_eligibility_flags(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.promotion_history.id }}">{{ form.promotion_history.label }}</label>
                        {{ form.promotion_history(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <label for="{{ form.expiration_alerts.id }}">{{ form.expiration_alerts.label }}</label>
                        {{ form.expiration_alerts(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                    </div>
                </div>
            </fieldset>
            {% if action == 'Create' %}
                <fieldset style="border: 1px solid #ddd; padding: 15px; border-radius: 4px;">
                    <legend style="font-weight: bold; padding: 0 10px;">User Creation</legend>
                    <div style="display: flex; gap: 20px;">
                        <div style="flex: 1;">
                            <label for="{{ user_form.username.id }}">{{ user_form.username.label }}</label>
                            {{ user_form.username(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                        </div>
                        <div style="flex: 1;">
                            <label for="{{ user_form.password.id }}">{{ user_form.password.label }}</label>
                            {{ user_form.password(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                        </div>
                        <div style="flex: 1;">
                            <label for="{{ user_form.role.id }}">{{ user_form.role.label }}</label>
                            {{ user_form.role(class="form-control", style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%;") }}
                        </div>
                    </div>
                    <div style="margin-top: 10px;">
                        <h4>Select Permissions</h4>
                        {% for page, subpages in permission_pages.items() %}
                            <div style="margin-bottom: 10px;">
                                <h5>{{ page|capitalize }}</h5>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    {% for subpage in subpages %}
                                        <label style="margin-right: 10px;">
                                            <input type="checkbox" name="{{ page }}_access" value="{{ subpage }}" style="margin-right: 5px;">
                                            {{ subpage|capitalize }}
                                        </label>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <button type="submit" name="create_user" style="padding: 10px 20px; background-color: {{ button_color|default('#1da1f2') }}; color: white; border: none; border-radius: 4px; cursor: pointer; transition: background-color 0.3s; margin-top: 10px;" onmouseover="this.style.backgroundColor='#1991e2'" onmouseout="this.style.backgroundColor='{{ button_color|default('#1da1f2') }}'">Create User</button>
                </fieldset>
            {% endif %}
            <button type="submit" style="padding: 10px 20px; background-color: {{ button_color|default('#1da1f2') }}; color: white; border: none; border-radius: 4px; cursor: pointer; transition: background-color 0.3s;" onmouseover="this.style.backgroundColor='#1991e2'" onmouseout="this.style.backgroundColor='{{ button_color|default('#1da1f2') }}'">{{ action }}</button>
        </form>
    </div>
{% endblock %}