<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; color: #333; }
    .header { text-align: center; margin-bottom: 40px; }
    .logo { font-size: 32px; font-weight: bold; color: #001f3f; }
    .info { display: flex; justify-content: space-between; margin: 40px 0; }
    table { width: 100%; border-collapse: collapse; margin: 30px 0; }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
    th { background: #001f3f; color: white; }
    .total { font-size: 20px; font-weight: bold; text-align: right; }
    .footer { margin-top: 60px; text-align: center; color: #666; font-size: 12px; }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">DC Solutions</div>
    <h1>INVOICE</h1>
    <h2>{{ invoice_number }}</h2>
  </div>

  <div class="info">
    <div>
      <strong>Bill To:</strong><br>
      {% if customer %}
        {{ customer.name }}<br>
        {{ customer.address|default('') }}<br>
        {{ customer.phone|default('') }}
      {% else %}
        Direct Client<br>
        Vessel: {{ job.vessel.vessel_name }}
      {% endif %}
    </div>
    <div>
      <strong>Date:</strong> {{ invoice_date }}<br>
      <strong>Job #:</strong> {{ job.job_number }}<br>
      <strong>Vessel:</strong> {{ job.vessel.vessel_name }}<br>
      <strong>Location:</strong> {{ job.location }}
    </div>
  </div>

  <h3>Service Performed:</h3>
  <p>{{ job.requested_service }}</p>

  <h3>Labor Detail</h3>
  <table>
    <tr>
      <th>Date</th>
      <th>Employee</th>
      <th>Hours</th>
      <th>Rate</th>
      <th>Total</th>
    </tr>
    {% for entry in time_entries if entry.billable == "Yes" %}
    {% set hours = (entry.stop_time.hour - entry.start_time.hour) + (entry.stop_time.minute - entry.start_time.minute)/60 %}
    <tr>
      <td>{{ entry.time_date.strftime('%m/%d') }}</td>
      <td>{{ entry.employee }}</td>
      <td>{{ "%.2f"|format(hours) }}</td>
      <td>${{ "%.2f"|format(entry.pay_rate_rt) }}</td>
      <td>${{ "%.2f"|format(hours * entry.pay_rate_rt) }}</td>
    </tr>
    {% endfor %}
  </table>

  <div class="total">
    Labor Total: {{ labor_total }}<br>
    Materials: {{ materials_total }}<br>
    <strong>TOTAL DUE: {{ total }}</strong>
  </div>

  <div class="footer">
    Thank you for your business!<br>
    DC Solutions • Maritime Services • Galveston, TX
  </div>
</body>
</html>