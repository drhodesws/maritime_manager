{% extends "base.html" %}
{% block content %}
<div class="container-fluid py-4">
  <h2 class="mb-5 text-primary">
    {% if role %}Edit Role: <strong>{{ role.name }}</strong>{% else %}Create New Role{% endif %}
  </h2>

  <div class="card shadow-lg border-0">
    <div class="card-body p-5">

      <form method="POST">
        <!-- Role Name -->
        <div class="mb-5">
          <label class="form-label fw-bold fs-4">Role Name</label>
          <input type="text" name="name" class="form-control form-control-lg" 
                 value="{{ role.name if role else '' }}" required autofocus>
        </div>

        <!-- Permissions â€” 8 COLUMNS WIDE, WORKING PERFECTLY -->
        <div class="mb-5">
          <label class="form-label fw-bold fs-4 mb-4">Permissions</label>

          {% for page, actions in permission_pages.items() %}
            <div class="card mb-5 border-0 shadow">
              <div class="card-header bg-primary text-white text-center py-4">
                <h4 class="mb-0"><strong>{{ page|replace('_', ' ')|title }}</strong></h4>
              </div>
              <div class="card-body py-5">
                <div class="table-responsive">
                  <table class="table table-borderless">
                    <tbody>
                      <tr>
                        {% for action in actions %}
                          <!-- Checkbox Column -->
                          <td class="text-end pe-3 align-middle" style="width: 60px;">
                            <div class="form-check">
                              <input class="form-check-input" type="checkbox"
                                     name="{{ page }}_{{ action }}"
                                     id="{{ page }}_{{ action }}"
                                     {% if checked.get(page + '_' + action) %}checked{% endif %}>
                            </div>
                          </td>
                          <!-- Label Column -->
                          <td class="align-middle ps-0">
                            <label class="form-check-label fw-bold fs-5" for="{{ page }}_{{ action }}">
                              {{ action|title }}
                            </label>
                          </td>
                        {% endfor %}
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>

        <!-- Buttons -->
        <div class="text-center pt-4">
          <button type="submit" class="btn btn-success btn-lg px-5 me-3">
            {% if role %}Update Role{% else %}Create Role{% endif %}
          </button>
          <a href="{{ url_for('control_panel.roles_list') }}" class="btn btn-secondary btn-lg px-4">
            Cancel
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}